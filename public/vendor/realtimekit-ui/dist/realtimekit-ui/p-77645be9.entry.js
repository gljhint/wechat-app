import{r as t,h as i,H as e,w as a,c as r}from"./p-0ee570cd.js";import{h as s}from"./p-3f882e7c.js";import{e as o,h as n,F as c}from"./p-3c9aa206.js";import{S as l}from"./p-e51bb952.js";const d=(t,i)=>{if(null==t)return;const e=Math.round(1.5),a=[...Array(3)].map(((t,a)=>{let r=a;return r>e-1&&(r=3-r-1),Math.round((r+1)/(e+1)*i)})),{width:r,height:s}=t,o=t.getContext("2d");let n=2;const c=1*r/a.length,l=c-4;o.clearRect(0,0,r,s),o.fillStyle="rgb(0,0,0,0.0)",o.fillRect(0,0,r,s);const d=getComputedStyle(t).getPropertyValue("color");o.fillStyle=d,o.strokeStyle=d,o.lineCap="round",o.lineWidth=4,o.beginPath();for(const t of a){const i=Math.min(-Math.abs(1.2*t/10*s)+s/2,s/2-2.5),e=Math.max(2*(s/2-i),5);o.moveTo(n+l/2,i),o.lineTo(n+l/2,i+e),n+=c}o.stroke()};var h=function(t,i,e,a){var r,s=arguments.length,o=s<3?i:null===a?a=Object.getOwnPropertyDescriptor(i,e):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,i,e,a);else for(var n=t.length-1;n>=0;n--)(r=t[n])&&(o=(s<3?r(o):s>3?r(i,e,o):r(i,e))||o);return s>3&&o&&Object.defineProperty(i,e,o),o};const p=class{constructor(i){t(this,i),this.variant="bars",this.iconPack=o,this.t=n(),this.hideMuted=!1,this.isScreenShare=!1,this.volume=0}connectedCallback(){this.participantChanged(this.participant)}componentDidLoad(){d(this.visualizer,0)}disconnectedCallback(){var t,i,e;null===(t=this.hark)||void 0===t||t.stop(),this.audioUpdateListener&&(null===(i=this.participant)||void 0===i||i.removeListener("audioUpdate",this.audioUpdateListener)),this.screenShareUpdateListener&&(null===(e=this.participant)||void 0===e||e.removeListener("screenShareUpdate",this.screenShareUpdateListener))}participantChanged(t){null!=t&&(this.audioUpdateListener=({audioEnabled:t,audioTrack:i})=>{var e;if(null===(e=this.hark)||void 0===e||e.stop(),t&&null!=i){this.audioEnabled=!0;const t=new MediaStream;t.addTrack(i),this.calcVolume(t),d(this.visualizer,0)}else this.volume=0,this.audioEnabled=!1},this.isScreenShare?(this.screenShareUpdateListener=({screenShareEnabled:t,screenShareTracks:i})=>{this.audioUpdateListener({audioEnabled:t&&null!=i.audio,audioTrack:i.audio})},this.screenShareUpdateListener({screenShareEnabled:t.screenShareEnabled,screenShareTracks:{audio:t.screenShareTracks.audio,video:t.screenShareTracks.video}}),t.addListener("screenShareUpdate",this.screenShareUpdateListener)):(this.audioUpdateListener(t),t.addListener("audioUpdate",this.audioUpdateListener)))}calcVolume(t){this.hark=s(t,{play:!1,interval:100}),this.hark.on("volume_change",(t=>{const i=this.volume;let e=Math.round(10**(t/115)*10);e<3&&(e=0);let a=Math.round((2*i+e)/3);i!==a&&(this.volume=a,d(this.visualizer,this.volume))}))}render(){return this.hideMuted&&!this.audioEnabled?null:i(e,null,i("div",{class:{audioActivePadding:this.hideMuted&&this.audioEnabled}},i("canvas",{width:"24",height:"24",class:{bars:!0,visible:this.audioEnabled},ref:t=>this.visualizer=t,part:"canvas"}),!this.isScreenShare&&!this.audioEnabled&&i("rtk-icon",{icon:this.iconPack.mic_off,part:"mic-off-icon"})))}static get watchers(){return{participant:["participantChanged"]}}};h([l()],p.prototype,"iconPack",void 0),h([l()],p.prototype,"t",void 0),p.style=":host{line-height:initial;font-family:var(--rtk-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--rtk-space-0, 0px);padding:var(--rtk-space-0, 0px)}:host{display:block;width:-moz-fit-content;width:fit-content}.audioActivePadding{padding:var(--rtk-space-1, 4px)}canvas,rtk-icon{height:var(--rtk-space-6, 24px);width:var(--rtk-space-6, 24px)}:host([size='sm']){transform:scale(0.9)}canvas{display:none}canvas.visible{display:block}canvas.bars{--tw-text-opacity:1;color:rgba(var(--rtk-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}";var v=function(t,i,e,a){var r,s=arguments.length,o=s<3?i:null===a?a=Object.getOwnPropertyDescriptor(i,e):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,i,e,a);else for(var n=t.length-1;n>=0;n--)(r=t[n])&&(o=(s<3?r(o):s>3?r(i,e,o):r(i,e))||o);return s>3&&o&&Object.defineProperty(i,e,o),o};const g=class{constructor(i){t(this,i),this.iconPack=o,this.variant="full",this.t=n(),this.audioinputDevices=[],this.canProduceAudio=!0,this.currentDevices={audio:void 0},this.stageStateListener=()=>{this.canProduceAudio="ALLOWED"===this.meeting.self.permissions.canProduceAudio},this.deviceListUpdateListener=async()=>{const t=await this.meeting.self.getAudioDevices();this.audioinputDevices=t},this.deviceUpdateListener=({device:t})=>{"audioinput"===t.kind&&(this.currentDevices={audio:t})},this.mediaPermissionUpdateListener=async({kind:t,message:i})=>{this.meeting&&"audio"===t&&"ACCEPTED"===i&&(this.audioinputDevices=await this.meeting.self.getAudioDevices())}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var t,i,e,a,r;null===(i=null===(t=this.meeting)||void 0===t?void 0:t.stage)||void 0===i||i.removeListener("stageStatusUpdate",this.stageStateListener),null===(e=this.meeting)||void 0===e||e.self.removeListener("deviceListUpdate",this.deviceListUpdateListener),null===(a=this.meeting)||void 0===a||a.self.removeListener("deviceUpdate",this.deviceUpdateListener),null===(r=this.meeting)||void 0===r||r.self.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener)}meetingChanged(t){t&&a((async()=>{var i,e;const{self:a,stage:r}=t,s=await t.self.getAudioDevices(),o=null===(i=t.self.getCurrentDevices())||void 0===i?void 0:i.audio;this.currentDevices={audio:o},this.canProduceAudio="ALLOWED"===t.self.permissions.canProduceAudio,null==r||r.addListener("stageStatusUpdate",this.stageStateListener),a.addListener("deviceListUpdate",this.deviceListUpdateListener),a.addListener("deviceUpdate",this.deviceUpdateListener),a.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),this.audioinputDevices=null!=o?[null!==(e=s.find((t=>t.deviceId===o.deviceId)))&&void 0!==e?e:o,...s.filter((t=>t.deviceId!==o.deviceId))]:s}))}setDevice(t){var i;if(c(this.meeting))return;const e=this.audioinputDevices.find((i=>i.deviceId===t));null!=e&&(this.currentDevices={audio:e},null===(i=this.meeting)||void 0===i||i.self.setDevice(e))}render(){if(!this.meeting)return null;let t=0;return i(e,null,this.canProduceAudio&&i("div",{part:"microphone-selection",class:"group container "+this.variant},i("label",{slot:"label"},"inline"!==this.variant&&this.t("settings.microphone_input"),i("rtk-icon",{icon:this.iconPack.mic_on,size:"sm"})),i("div",{class:"row"},i("select",{class:"rtk-select",onChange:t=>this.setDevice(t.target.value)},this.audioinputDevices.map((({deviceId:e,label:a})=>{var r;return i("option",{value:e,selected:(null===(r=this.currentDevices.audio)||void 0===r?void 0:r.deviceId)===e},a||"Microphone "+ ++t)}))),i("slot",{name:"indicator"}))))}static get watchers(){return{meeting:["meetingChanged"]}}};v([l()],g.prototype,"meeting",void 0),v([l()],g.prototype,"iconPack",void 0),v([l()],g.prototype,"t",void 0),g.style=".rtk-select{--tw-bg-opacity:1;background-color:rgba(var(--rtk-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--rtk-colors-text-1000, 255 255 255))}.rtk-select:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.rtk-select{display:block;border-radius:var(--rtk-border-radius-sm, 4px);border-width:var(--rtk-border-width-none, 0);border-style:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:var(--rtk-space-3, 12px);font-size:16px;--icon-size:var(--rtk-select-chevron-size, var(--rtk-space-6, 24px));--icon-right-position:var(--rtk-select-chevron-right-position, var(--rtk-space-2, 8px));background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\");background-position:right var(--icon-right-position) center;background-repeat:no-repeat;background-size:var(--icon-size) var(--icon-size);padding-right:calc(var(--icon-right-position) * 5);width:100%;max-width:100%;text-overflow:ellipsis}.inline .rtk-select{margin-top:var(--rtk-space-1, 4px);width:100%;padding-top:var(--rtk-space-1, 4px);padding-bottom:var(--rtk-space-1, 4px);padding-left:var(--rtk-space-1\\.5, 6px);padding-right:var(--rtk-space-1\\.5, 6px);padding-right:var(--rtk-space-8, 32px);font-size:14px}.row{margin-bottom:var(--rtk-space-2, 8px);display:flex;width:100%;align-items:center;justify-content:space-between;gap:var(--rtk-space-3, 12px)}.group{margin-top:var(--rtk-space-2, 8px);margin-bottom:var(--rtk-space-2, 8px)}.group>*{margin-bottom:var(--rtk-space-2, 8px)}.group>*:last-child{margin-bottom:var(--rtk-space-0, 0px)}.group select{flex:1 1 0%}.inline.group{margin-top:var(--rtk-space-0, 0px);margin-bottom:var(--rtk-space-0\\.5, 2px)}.inline.group>*{margin-bottom:var(--rtk-space-0, 0px)}label{display:flex;-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center;gap:var(--rtk-space-1, 4px);font-size:14px}.inline.container{display:flex;align-items:center;justify-content:flex-start;gap:var(--rtk-space-2, 8px);padding-left:var(--rtk-space-2, 8px);padding-right:var(--rtk-space-2, 8px)}";var u=function(t,i,e,a){var r,s=arguments.length,o=s<3?i:null===a?a=Object.getOwnPropertyDescriptor(i,e):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,i,e,a);else for(var n=t.length-1;n>=0;n--)(r=t[n])&&(o=(s<3?r(o):s>3?r(i,e,o):r(i,e))||o);return s>3&&o&&Object.defineProperty(i,e,o),o};const k=class{constructor(i){t(this,i),this.variant="full",this.iconPack=o,this.t=n(),this.speakerDevices=[],this.currentDevices={speaker:void 0},this.deviceListUpdateListener=async()=>{const t=await this.meeting.self.getSpeakerDevices();this.speakerDevices=t},this.deviceUpdateListener=({device:t})=>{"audiooutput"===t.kind&&(this.currentDevices={speaker:t})},this.mediaPermissionUpdate=async({kind:t,message:i})=>{this.meeting&&"audio"===t&&"ACCEPTED"===i&&(this.speakerDevices=await this.meeting.self.getSpeakerDevices())}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var t,i,e;null===(t=this.meeting)||void 0===t||t.self.removeListener("deviceListUpdate",this.deviceListUpdateListener),null===(i=this.meeting)||void 0===i||i.self.removeListener("deviceUpdate",this.deviceUpdateListener),null===(e=this.meeting)||void 0===e||e.self.addListener("mediaPermissionUpdate",this.mediaPermissionUpdate)}meetingChanged(t){t&&a((async()=>{var i,e;const{self:a}=t,r=await t.self.getSpeakerDevices(),s=null===(i=t.self.getCurrentDevices())||void 0===i?void 0:i.speaker;this.currentDevices={speaker:s},a.addListener("deviceListUpdate",this.deviceListUpdateListener),a.addListener("deviceUpdate",this.deviceUpdateListener),a.addListener("mediaPermissionUpdate",this.mediaPermissionUpdate),this.speakerDevices=null!=s?[null!==(e=r.find((t=>t.deviceId===s.deviceId)))&&void 0!==e?e:s,...r.filter((t=>t.deviceId!==s.deviceId))]:r}))}testAudio(){var t;null===(t=this.testAudioEl)||void 0===t||t.play()}setDevice(t){var i,e;if(c(this.meeting))return;const a=this.speakerDevices.find((i=>i.deviceId===t));this.currentDevices={speaker:a},null!=a&&(null===(i=this.meeting)||void 0===i||i.self.setDevice(a),null===(e=this.testAudioEl)||void 0===e||e.setSinkId(a.deviceId))}render(){if(!this.meeting)return null;let t=0;return i(e,null,i("audio",{preload:"auto",src:"https://assets.dyte.io/ui-kit/speaker-test.mp3",ref:t=>this.testAudioEl=t}),i("div",{class:"group "+this.variant,part:"speaker-selection"},this.speakerDevices.length>0&&!c(this.meeting)&&i("div",{class:"container"},i("label",null,"inline"!==this.variant&&this.t("settings.speaker_output"),i("rtk-icon",{icon:this.iconPack.speaker,size:"sm"})),i("div",{class:"row"},i("select",{class:"rtk-select",onChange:t=>this.setDevice(t.target.value)},this.speakerDevices.map((({deviceId:e,label:a})=>{var r;return i("option",{value:e,selected:(null===(r=this.currentDevices.speaker)||void 0===r?void 0:r.deviceId)===e},a||"Speaker "+ ++t)}))))),"full"===this.variant&&i("rtk-button",{variant:"secondary",onClick:()=>this.testAudio()},i("rtk-icon",{icon:this.iconPack.speaker,slot:"start"}),this.t("test"))))}static get watchers(){return{meeting:["meetingChanged"]}}};u([l()],k.prototype,"meeting",void 0),u([l()],k.prototype,"states",void 0),u([l()],k.prototype,"iconPack",void 0),u([l()],k.prototype,"t",void 0),k.style=".rtk-select{--tw-bg-opacity:1;background-color:rgba(var(--rtk-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--rtk-colors-text-1000, 255 255 255))}.rtk-select:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.rtk-select{display:block;border-radius:var(--rtk-border-radius-sm, 4px);border-width:var(--rtk-border-width-none, 0);border-style:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:var(--rtk-space-3, 12px);font-size:16px;--icon-size:var(--rtk-select-chevron-size, var(--rtk-space-6, 24px));--icon-right-position:var(--rtk-select-chevron-right-position, var(--rtk-space-2, 8px));background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\");background-position:right var(--icon-right-position) center;background-repeat:no-repeat;background-size:var(--icon-size) var(--icon-size);padding-right:calc(var(--icon-right-position) * 5);width:100%;max-width:100%;text-overflow:ellipsis}.inline .rtk-select{margin-top:var(--rtk-space-1, 4px);width:100%;padding-top:var(--rtk-space-1, 4px);padding-bottom:var(--rtk-space-1, 4px);padding-left:var(--rtk-space-1\\.5, 6px);padding-right:var(--rtk-space-1\\.5, 6px);padding-right:var(--rtk-space-8, 32px);font-size:14px}.row{display:flex;width:100%;align-items:center;justify-content:space-between;gap:var(--rtk-space-3, 12px)}.group{margin-top:var(--rtk-space-2, 8px);margin-bottom:var(--rtk-space-2, 8px)}.group>*{margin-bottom:var(--rtk-space-2, 8px)}.group>*:last-child{margin-bottom:var(--rtk-space-0, 0px)}.group select{flex:1 1 0%}.inline.group{margin-top:var(--rtk-space-0, 0px);margin-bottom:var(--rtk-space-0\\.5, 2px)}.inline.group>*{margin-bottom:var(--rtk-space-0, 0px)}label{display:flex;-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center;gap:var(--rtk-space-1, 4px);font-size:14px}.inline .container{display:flex;align-items:center;justify-content:flex-start;gap:var(--rtk-space-2, 8px);padding-left:var(--rtk-space-2, 8px);padding-right:var(--rtk-space-2, 8px)}";var f=function(t,i,e,a){var r,s=arguments.length,o=s<3?i:null===a?a=Object.getOwnPropertyDescriptor(i,e):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,i,e,a);else for(var n=t.length-1;n>=0;n--)(r=t[n])&&(o=(s<3?r(o):s>3?r(i,e,o):r(i,e))||o);return s>3&&o&&Object.defineProperty(i,e,o),o};const b=class{constructor(i){t(this,i),this.onChange=r(this,"rtkChange",4),this.checked=!1,this.readonly=!1,this.disabled=!1,this.iconPack=o,this.t=n(),this.onClick=()=>{this.readonly||this.disabled||(this.checked=!this.checked)},this.onKeyPress=t=>{if(!this.readonly)switch(t.key){case"Enter":case" ":this.checked=!this.checked}}}connectedCallback(){this.checkedChange(this.checked)}checkedChange(t){this.checked=t,this.onChange.emit(t)}render(){return i(e,{key:"74affe48ce91e7be340e9d37507859fdd473bcb1",role:"switch",tabIndex:this.disabled&&0,"aria-readonly":this.readonly,"aria-checked":this.checked,"aria-disabled":this.disabled,class:{checked:this.checked},onClick:this.onClick,onKeyPress:this.onKeyPress},i("div",{key:"24ae27603c839d40d6452c5ee669342acb60f73d",class:"switch",part:"switch"}))}static get watchers(){return{checked:["checkedChange"]}}};f([l()],b.prototype,"iconPack",void 0),f([l()],b.prototype,"t",void 0),b.style=":host{line-height:initial;font-family:var(--rtk-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--rtk-space-0, 0px);padding:var(--rtk-space-0, 0px)}:host{box-sizing:border-box;display:inline-flex;height:var(--rtk-space-6, 24px);width:var(--rtk-space-10, 40px);align-items:center;padding:var(--rtk-space-1, 4px);border-radius:9999px;background-color:rgb(var(--rtk-colors-text-600, 255 255 255 / 0.52));cursor:pointer}.switch{box-sizing:border-box;height:var(--rtk-space-4, 16px);width:var(--rtk-space-4, 16px);background-color:rgb(var(--rtk-colors-text-on-brand-1000, var(--rtk-colors-text-1000, 255 255 255)));border-radius:9999px;transition-property:var(--rtk-transition-property, all);transition-duration:200ms}:host(.checked){--tw-bg-opacity:1;background-color:rgba(var(--rtk-colors-brand-500, 33 96 253) / var(--tw-bg-opacity))}:host(.checked) .switch{transform:translateX(100%)}:host([readonly]),:host([disabled]){cursor:not-allowed;opacity:0.6}";export{p as rtk_audio_visualizer,g as rtk_microphone_selector,k as rtk_speaker_selector,b as rtk_switch}